<!-- Header with Help Icon -->
<div *ngIf="showTitle" class="header-row" style="display: flex; align-items: center; justify-content: space-between;">
  <h2 style="margin: 0;">{{ popupTitle }}</h2>

  <mat-icon
    *ngIf="enableItemPopup"
    style="cursor: pointer; margin-left: 10px;"
    class="help-icon"
    (click)="toggleGif()">help</mat-icon>
</div>

<!-- Help GIF Floating Window -->
<div *ngIf="enableItemPopup && showGif" class="gif-help-popup">
  <div class="gif-help-header">
    <span class="material-icons">visibility</span>
    <span>Click the <strong>More Details</strong> icon to view item information</span>
  </div>
  <img src="https://cdn.imgchest.com/files/y8xcnkk5jx4.gif" alt="Help GIF" />
</div>


<br *ngIf="showTitle" />

<!-- Main Table -->
<ag-grid-angular
  class="ag-theme-alpine"
  [rowData]="rowData"
  [columnDefs]="columnDefs"
  [defaultColDef]="defaultColDef"
  rowSelection="single"
  [pagination]="true"
  [paginationPageSize]="10"
  style="width: 100%; height: 450px;"
  (cellClicked)="onRowClicked($event)">
</ag-grid-angular>


<!-- Popup Items Table -->
<div *ngIf="enableItemPopup && showDetailPopup" class="popup-overlay">
  <div class="popup-content">
    <div class="popup-header">
      <h3 class="h3">
        Items for {{ formatTitle(popupTitle) }}
        <span *ngIf="selectedRow">
          #{{ selectedRow?.invoiceNo || selectedRow?.vbeln || selectedRow?.ebeln || selectedRow?.belnr || 'N/A' }}
        </span>
      </h3>

      <div class="header-buttons">
        <button *ngIf="enableDownload" class="download-btn" title="Download PDF" (click)="triggerDownload()">
          <span class="material-icons">download</span>
        </button>
        <button class="close-btn" (click)="closeDetailPopup()" title="Close">
          <span class="material-icons">close</span>
        </button>
      </div>
    </div>

    <br>

<ag-grid-angular
  class="ag-theme-alpine"
  [rowData]="selectedItems"
  [columnDefs]="itemColumnDefs"
  [defaultColDef]="defaultColDef"
  [pagination]="true"
  [paginationPageSize]="5"
  style="width: 100%; height: 300px;">
</ag-grid-angular>

  </div>
</div>
